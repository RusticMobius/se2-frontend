{"remainingRequest":"/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/src/views/teacher/QuestionCreate.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/src/views/teacher/QuestionCreate.vue","mtime":1625884887859},{"path":"/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/scarlett/IdeaProjects/35cf82cde2094d8a989779d9507bd7a7/front_end/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldFRlYWNoZXJDb3Vyc2VzfSBmcm9tICJAL2FwaS9jb3Vyc2UiOwppbXBvcnQge2NyZWF0ZVF1ZXN0aW9ufSBmcm9tICJAL2FwaS9xdWVzdGlvbiI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlF1ZXN0aW9uQ3JlYXRlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcXVlc0luZm86IHsKICAgICAgICB0eXBlOiBudWxsLAogICAgICAgIGNvbnRlbnQ6bnVsbCwKICAgICAgICBhbmFseXNpczogbnVsbCwKICAgICAgICBjb3Vyc2VJZDogbnVsbCwKICAgICAgICBhbnN3ZXI6bnVsbCwKICAgICAgICB0ZWFjaGVySWQ6bnVsbCwKICAgICAgfSwKICAgICAgdGVtcENvbnRlbnQ6bnVsbCwKICAgICAgY291cnNlTmFtZTpudWxsLAogICAgICB0eXBlczogWyLljZXpgIkiLCAi5aSa6YCJIiwi5aGr56m6Il0sCiAgICAgIG9wdGlvbjpbXSwKICAgICAgY291cnNlTmFtZUxpc3RzOltdLAogICAgICBjb3Vyc2VMaXN0OltdLAogICAgICBkaWFsb2c6IGZhbHNlLAogICAgICBzaG93U3VjY2Vzc0RpYWxvZzogZmFsc2UsCiAgICAgIHNob3dGYWlsRGlhbG9nOiBmYWxzZSwKICAgICAgbXNnOiAiIgogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICBjb25zdCB1aWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJZCIpOwogICAgaWYgKHVpZCkgewogICAgICBnZXRUZWFjaGVyQ291cnNlcyh1aWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAvL2NvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgZm9yKHZhciBpPTA7aTxyZXMubGVuZ3RoO2krKyl7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNbaV0pCiAgICAgICAgICB0aGlzLmNvdXJzZU5hbWVMaXN0cy5wdXNoKHJlc1tpXS5uYW1lKTsKICAgICAgICAgIHRoaXMuY291cnNlTGlzdC5wdXNoKHsibmFtZSI6cmVzW2ldLm5hbWUsImlkIjpyZXNbaV0uaWR9KQogICAgICAgIH0KICAgICAgfSk7CgogICAgfQoKICB9LAogIG1ldGhvZHM6ewogICAgY29udGVudFByb2Nlc3MoKXsKICAgICAgaWYodGhpcy5xdWVzSW5mby50eXBlIT09IuWhq+epuiIpewogICAgICAgIHRoaXMucXVlc0luZm8uY29udGVudD10aGlzLnRlbXBDb250ZW50LnJlcGxhY2VBbGwoJ1xuJywiI34jIik7CiAgICAgICAgY29uc29sZS5sb2codGhpcy5xdWVzSW5mby5jb250ZW50KTsKICAgICAgfWVsc2V7CiAgICAgICAgdGhpcy5xdWVzSW5mby5jb250ZW50PXRoaXMudGVtcENvbnRlbnQ7CiAgICAgIH0KICAgIH0sCiAgICBzZXRDb3Vyc2VJZCgpewogICAgICBmb3IobGV0IGk9MDtpPHRoaXMuY291cnNlTGlzdC5sZW5ndGg7aSsrKXsKICAgICAgICBpZih0aGlzLmNvdXJzZU5hbWU9PT10aGlzLmNvdXJzZUxpc3RbaV0ubmFtZSl7CiAgICAgICAgICB0aGlzLnF1ZXNJbmZvLmNvdXJzZUlkPXRoaXMuY291cnNlTGlzdFtpXS5pZDsKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMucXVlc0luZm8uY291cnNlSWQpCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc3VibWl0KCkgewogICAgICB0aGlzLmNvbnRlbnRQcm9jZXNzKCk7CiAgICAgIGNvbnNvbGUubG9nKCJJJ20gc3VibWl0aW5nIikKICAgICAgaWYodGhpcy5xdWVzSW5mby5jb250ZW50PT09bnVsbCB8fCB0aGlzLnF1ZXNJbmZvLmNvbnRlbnQ9PT0iInx8CiAgICAgIHRoaXMucXVlc0luZm8uY291cnNlSWQ9PT1udWxsfHwKICAgICAgdGhpcy5xdWVzSW5mby5hbnN3ZXI9PT1udWxsfHx0aGlzLnF1ZXNJbmZvLmFuc3dlcj09PSIifHwKICAgICAgdGhpcy5xdWVzSW5mby50eXBlPT09bnVsbHx8dGhpcy5xdWVzSW5mby5hbnN3ZXI9PT0iIikgewogICAgICAgIHRoaXMuc2hvd0ZhaWxEaWFsb2cgPSB0cnVlOwogICAgICAgIHRoaXMubXNnID0gIuW/heWhq+S/oeaBr+S4jeiDveS4uuepuiI7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dGYWlsRGlhbG9nID0gZmFsc2U7CiAgICAgICAgfSwgMTAwMCk7CiAgICAgIH1lbHNlIGlmKCF0aGlzLmNoZWNrQW5zd2VyRm9ybWF0KCkpewogICAgICAgIHRoaXMuc2hvd0ZhaWxEaWFsb2cgPSB0cnVlOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgdGhpcy5zaG93RmFpbERpYWxvZyA9IGZhbHNlOwogICAgICAgIH0sIDEwMDApOwogICAgICB9ZWxzZXsKCiAgICAgICAgY29uc3QgdWlkPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJZCIpOwogICAgICAgIHRoaXMucXVlc0luZm8udGVhY2hlcklkPXVpZDsKICAgICAgICBjb25zdCBwYXlsb2FkPXsKICAgICAgICAgIC4uLnRoaXMucXVlc0luZm8sCiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKHBheWxvYWQpCiAgICAgICAgaWYodWlkKXsKICAgICAgICAgIGNyZWF0ZVF1ZXN0aW9uKHBheWxvYWQpLnRoZW4ocmVzPT57CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMSkgewogICAgICAgICAgICAgIHRoaXMuc2hvd1N1Y2Nlc3NEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5zaG93U3VjY2Vzc0RpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuc2hvd0ZhaWxEaWFsb2cgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMubXNnID0gcmVzLm1zZzsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0ZhaWxEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2hlY2tBbnN3ZXJGb3JtYXQoKXsvLzE1MwogICAgICBpZih0aGlzLnF1ZXNJbmZvLnR5cGU9PT0n5aGr56m6Jyl7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgaWYodGhpcy5xdWVzSW5mby50eXBlPT09IuWNlemAiSImJnRoaXMucXVlc0luZm8uYW5zd2VyLmxlbmd0aD4xKXsKICAgICAgICB0aGlzLm1zZz0i5Y2V6YCJ6aKY562U5qGI6YCJ6aG55pWw5LiN6IO95aSa5LqOMSI7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBhbnN3ZXJCb2R5TGlzdD10aGlzLnF1ZXNJbmZvLmNvbnRlbnQuc3BsaXQoIiN+IyIpLnNsaWNlKDEpOwogICAgICB2YXIgYW5zd2VyT3BMaXN0PVtdOwoKICAgICAgZm9yKGxldCBpPTA7aTxhbnN3ZXJCb2R5TGlzdC5sZW5ndGg7aSsrKXsKICAgICAgICBsZXQgb3AgPSBhbnN3ZXJCb2R5TGlzdFtpXS5zcGxpdCgnLicsMSlbMF07CiAgICAgICAgY29uc29sZS5sb2cob3AubGVuZ3RoKQogICAgICAgIGlmKG9wLmxlbmd0aD4xKXsKICAgICAgICAgIHRoaXMubXNnPSLpgInpobnmoLzlvI/pnZ7ms5UiOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH1lbHNle2Fuc3dlck9wTGlzdC5wdXNoKG9wKX0KICAgICAgfQogICAgICBjb25zb2xlLmxvZyhhbnN3ZXJPcExpc3QpCiAgICAgIHZhciBhbnN3ZXJMaXN0PXRoaXMucXVlc0luZm8uYW5zd2VyLnNwbGl0KCcnKTsKICAgICAgaWYoYW5zd2VyT3BMaXN0Lmxlbmd0aDw9MSl7CiAgICAgICAgdGhpcy5tc2c9IumAieaLqemimOiHs+WwkeWMheWQq+S4pOS4qumAiemhuSI7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGZvcihsZXQgaT0wO2k8YW5zd2VyTGlzdC5sZW5ndGg7aSsrKXsKICAgICAgICBpZihhbnN3ZXJPcExpc3QuaW5kZXhPZihhbnN3ZXJMaXN0W2ldKT09PS0xKXsKICAgICAgICAgIGNvbnNvbGUubG9nKGFuc3dlckxpc3RbaV0pCiAgICAgICAgICB0aGlzLm1zZz0i562U5qGI5LiN5YyF5ous5Zyo6K6+572u55qE6YCJ6aG55YaF77yM6K+35qOA5p+lIgogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCgogIH0sCgp9Cgo="},{"version":3,"sources":["QuestionCreate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiFA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"QuestionCreate.vue","sourceRoot":"src/views/teacher","sourcesContent":["<template>\n  <div>\n    <v-alert\n        class=\"alert\"\n        type=\"success\"\n        text\n        v-show=\"showSuccessDialog\"\n        transition=\"scroll-y-transition\"\n    >\n      习题创建成功！\n    </v-alert>\n    <!-- alert -->\n    <v-alert\n        class=\"alert\"\n        type=\"warning\"\n        text\n        v-show=\"showFailDialog\"\n        transition=\"scroll-y-transition\"\n    >\n      {{ msg }}\n    </v-alert>\n    <v-container class=\"pl-16 pr-16\">\n      <v-toolbar color=\"deep-purple lighten-2\" dark class=\"mt-10\">\n        <v-toolbar-title>题目信息</v-toolbar-title>\n      </v-toolbar>\n      <form class=\"pa-12 grey lighten-5 mt-8\">\n        <v-select\n            :items=\"courseNameLists\"\n            v-model=\"courseName\"\n            label=\"所属课程\"\n            @change=\"setCourseId\"\n        ></v-select>\n        <v-select\n          :items=\"types\"\n          v-model=\"quesInfo.type\"\n          label=\"题目类型\">\n        </v-select>\n        <v-textarea\n            v-model=\"tempContent\"\n            label=\"题干信息\"\n            placeholder=\"选择题输入选项前请换行\"\n        ></v-textarea>\n\n        <v-text-field\n            v-model=\"quesInfo.answer\"\n            label=\"答案\"\n            placeholder=\"请区分大小写\"\n        ></v-text-field>\n        <v-textarea v-model=\"quesInfo.analysis\" label=\"题目解析\"></v-textarea>\n        <v-btn class=\"ml-0 mt-8 \" color=\"indigo\" outlined @click=\"submit\">\n          确认\n        </v-btn>\n      </form>\n\n\n    </v-container>\n\n    <!-- 提示对话框 -->\n    <v-dialog v-model=\"dialog\" width=\"500\">\n      <v-card>\n        <v-card-title> </v-card-title>\n\n        <v-card-text>\n          专题创建成功。\n        </v-card-text>\n\n        <v-divider></v-divider>\n\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"primary\" text @click=\"dialog = false\">\n            确认\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n\n</template>\n\n<script>\nimport { getTeacherCourses} from \"@/api/course\";\nimport {createQuestion} from \"@/api/question\";\n\nexport default {\n  name: \"QuestionCreate\",\n  data() {\n    return {\n      quesInfo: {\n        type: null,\n        content:null,\n        analysis: null,\n        courseId: null,\n        answer:null,\n        teacherId:null,\n      },\n      tempContent:null,\n      courseName:null,\n      types: [\"单选\", \"多选\",\"填空\"],\n      option:[],\n      courseNameLists:[],\n      courseList:[],\n      dialog: false,\n      showSuccessDialog: false,\n      showFailDialog: false,\n      msg: \"\"\n    };\n  },\n  mounted() {\n    const uid = window.localStorage.getItem(\"userId\");\n    if (uid) {\n      getTeacherCourses(uid).then(res => {\n        //console.log(res);\n        for(var i=0;i<res.length;i++){\n          console.log(res[i])\n          this.courseNameLists.push(res[i].name);\n          this.courseList.push({\"name\":res[i].name,\"id\":res[i].id})\n        }\n      });\n\n    }\n\n  },\n  methods:{\n    contentProcess(){\n      if(this.quesInfo.type!==\"填空\"){\n        this.quesInfo.content=this.tempContent.replaceAll('\\n',\"#~#\");\n        console.log(this.quesInfo.content);\n      }else{\n        this.quesInfo.content=this.tempContent;\n      }\n    },\n    setCourseId(){\n      for(let i=0;i<this.courseList.length;i++){\n        if(this.courseName===this.courseList[i].name){\n          this.quesInfo.courseId=this.courseList[i].id;\n          console.log(this.quesInfo.courseId)\n        }\n      }\n    },\n    submit() {\n      this.contentProcess();\n      console.log(\"I'm submiting\")\n      if(this.quesInfo.content===null || this.quesInfo.content===\"\"||\n      this.quesInfo.courseId===null||\n      this.quesInfo.answer===null||this.quesInfo.answer===\"\"||\n      this.quesInfo.type===null||this.quesInfo.answer===\"\") {\n        this.showFailDialog = true;\n        this.msg = \"必填信息不能为空\";\n        setTimeout(() => {\n          this.showFailDialog = false;\n        }, 1000);\n      }else if(!this.checkAnswerFormat()){\n        this.showFailDialog = true;\n        setTimeout(() => {\n          this.showFailDialog = false;\n        }, 1000);\n      }else{\n\n        const uid= window.localStorage.getItem(\"userId\");\n        this.quesInfo.teacherId=uid;\n        const payload={\n          ...this.quesInfo,\n        }\n        console.log(payload)\n        if(uid){\n          createQuestion(payload).then(res=>{\n            console.log(res);\n            if (res.code === 1) {\n              this.showSuccessDialog = true;\n              setTimeout(() => {\n                this.showSuccessDialog = false;\n              }, 1000);\n            } else {\n              this.showFailDialog = true;\n              this.msg = res.msg;\n              setTimeout(() => {\n                this.showFailDialog = false;\n              }, 1000);\n            }\n          });\n        }\n      }\n    },\n    checkAnswerFormat(){//153\n      if(this.quesInfo.type==='填空'){\n        return true;\n      }\n      if(this.quesInfo.type===\"单选\"&&this.quesInfo.answer.length>1){\n        this.msg=\"单选题答案选项数不能多于1\";\n        return false;\n      }\n      var answerBodyList=this.quesInfo.content.split(\"#~#\").slice(1);\n      var answerOpList=[];\n\n      for(let i=0;i<answerBodyList.length;i++){\n        let op = answerBodyList[i].split('.',1)[0];\n        console.log(op.length)\n        if(op.length>1){\n          this.msg=\"选项格式非法\";\n          return false;\n        }else{answerOpList.push(op)}\n      }\n      console.log(answerOpList)\n      var answerList=this.quesInfo.answer.split('');\n      if(answerOpList.length<=1){\n        this.msg=\"选择题至少包含两个选项\";\n        return false;\n      }\n      for(let i=0;i<answerList.length;i++){\n        if(answerOpList.indexOf(answerList[i])===-1){\n          console.log(answerList[i])\n          this.msg=\"答案不包括在设置的选项内，请检查\"\n          return false;\n        }\n      }\n      return true;\n    },\n\n  },\n\n}\n\n</script>\n\n<style scoped>\n.alert {\n  position: fixed;\n  left: 50%;\n  top: 200px;\n  z-index: 999;\n}\n</style>"]}]}